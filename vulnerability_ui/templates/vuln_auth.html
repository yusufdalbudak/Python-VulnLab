{% extends 'base.html' %}

{% block content %}
<h1>01. Broken Authentication & BOLA</h1>
<p class="mb-4">This page demonstrates two common vulnerabilities: Weak Login and Broken Object Level Authorization
    (BOLA).</p>

<div class="grid">
    <!-- Login Demo -->
    <div class="card">
        <h3>Vulnerable Login</h3>
        <p>Try to brute force or guess the credentials. (Hint: admin / 123456)</p>

        {% if login_result %}
        {% if login_result.status == 'success' %}
        <div class="alert alert-success">{{ login_result.msg }}</div>
        {% else %}
        <div class="alert alert-error">{{ login_result.msg }}</div>
        {% endif %}
        {% endif %}

        <form action="{{ url_for('vuln_auth') }}" method="POST">
            <div class="form-group">
                <label for="username">Username</label>
                <input type="text" id="username" name="username" placeholder="Enter username">
            </div>
            <div class="form-group">
                <label for="password">Password</label>
                <input type="password" id="password" name="password" placeholder="Enter password">
            </div>
            <button type="submit" class="btn">Login</button>
        </form>
    </div>

    <!-- BOLA Demo -->
    <div class="card">
        <h3>BOLA / IDOR</h3>
        <p>Access invoices by ID without ownership checks. Try ID 1 or 2.</p>

        {% if invoice_result %}
        <div class="alert {% if invoice_result.error %}alert-error{% else %}alert-success{% endif %}">
            <pre>{{ invoice_result | tojson(indent=2) }}</pre>
        </div>
        {% endif %}

        <form action="{{ url_for('vuln_auth_invoice') }}" method="POST">
            <div class="form-group">
                <label for="invoice_id">Invoice ID</label>
                <input type="text" id="invoice_id" name="invoice_id" placeholder="e.g., 1">
            </div>
            <button type="submit" class="btn">Fetch Invoice</button>
        </form>
    </div>
</div>

<div style="margin-top: 2rem;">
    <a href="/" class="btn btn-danger">Back to Dashboard</a>
</div>
{% endblock %}